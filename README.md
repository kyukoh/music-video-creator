# Music Video Creator - 使用マニュアル

## 概要

Music Video Creatorは、ミュージックビデオの制作をサポートするローカル環境用Webアプリケーションです。楽曲をシーンごとに分割し、各シーンの歌詞、説明、画像・動画生成プロンプト、メディアファイルを統合的に管理できます。

## 主な機能

- **プロジェクト管理**: 楽曲ごとのプロジェクト作成・管理
- **シーン管理**: 楽曲をシーンに分割し、詳細情報を管理
- **メディアライブラリ**: プロジェクトごとの画像・動画ファイル管理
- **インライン編集**: シーン一覧画面での直接編集
- **ファイルアップロード**: ドラッグ&ドロップによる簡単アップロード
- **一括登録**: テキストファイルやExcelファイルからのシーン一括登録

## システム要件

### 必要なソフトウェア

- **PHP**: バージョン 7.4 以上（内蔵サーバー使用）
- **Webブラウザー**: Chrome、Firefox、Safari、Edge（最新版推奨）

### PHPのインストール確認

PHPがインストールされているか確認：

```bash
php --version
```

PHPがインストールされていない場合：

**Mac（Homebrew使用）:**
```bash
brew install php
```

**Windows:**
- [PHP公式サイト](https://www.php.net/downloads.php)からダウンロード
- または [Chocolatey](https://chocolatey.org/)を使用: `choco install php`

**Ubuntu/Debian:**
```bash
sudo apt update
sudo apt install php php-json php-mbstring
```

## 簡単セットアップ（推奨）

### 1. プロジェクトファイルのダウンロード

プロジェクトファイルを任意のフォルダに配置します。

### 2. アプリケーションの起動

ターミナル（コマンドプロンプト）で以下を実行：

```bash
# プロジェクトディレクトリに移動
cd music-video-creator/public

# PHPの内蔵サーバーを起動
php -S localhost:8000
```

### 3. ブラウザでアクセス

ブラウザで以下のURLにアクセス：
```
http://localhost:8000
```

**これだけで完了です！** 追加のソフトウェアは不要です。

## 高度なセットアップ（オプション）

Apache や Nginx を使用したい場合のみ、以下の設定を行ってください：

### ディレクトリ権限の設定

```bash
chmod 755 music-video-creator/data/
chmod 755 music-video-creator/data/projects/
```

## 基本的な使い方

### 1. プロジェクトの作成

1. アプリケーションを起動すると、左側にプロジェクト一覧が表示されます
2. 「新規プロジェクト」ボタンをクリック
3. 楽曲名と備考を入力
4. 「作成」ボタンをクリックしてプロジェクトを作成

### 2. シーンの管理

#### 手動でシーンを追加

1. プロジェクトを選択してシーン一覧画面に移動
2. 「シーン追加」ボタンをクリック
3. 各フィールドを直接編集：
   - **開始時間**: シーンの開始時間（分:秒形式）
   - **歌詞**: そのシーンで歌われる歌詞
   - **シーン説明**: 映像の内容やコンセプト
   - **英語プロンプト**: AI生成用のプロンプト

#### ファイルからシーンを一括登録

1. 「ファイルアップロード」ボタンをクリック
2. 以下のいずれかの形式のファイルを選択：

**簡易版（テキストファイル）**
```
歌詞の1行目
歌詞の2行目
歌詞の3行目
```

**詳細版（CSVファイル）**
```csv
start_time,lyrics,description,image_prompt,video_prompt
0:00,歌詞1行目,シーン1の説明,画像プロンプト1,動画プロンプト1
0:15,歌詞2行目,シーン2の説明,画像プロンプト2,動画プロンプト2
```

### 3. メディアライブラリの使用

#### ファイルのアップロード

1. 「メディアライブラリ」ボタンをクリック
2. ドラッグ&ドロップエリアにファイルをドロップ
3. または「ファイルを選択」ボタンでファイルを選択
4. 対応形式：
   - **画像**: JPG, PNG, GIF
   - **動画**: MP4, MOV, AVI

#### ファイルの管理

- **フィルタリング**: 「全て表示」「画像のみ」「動画のみ」で表示を切り替え
- **選択**: ファイルをクリックして選択状態に
- **削除**: 選択したファイルを削除（関連するシーンからも自動的に解除）

### 4. シーンの詳細編集

1. シーン一覧でサムネイル画像をクリック
2. 詳細編集画面で以下を設定：
   - **画像生成プロンプト**: AI画像生成用の詳細プロンプト
   - **画像ファイル**: メディアライブラリから画像を選択
   - **動画生成プロンプト**: AI動画生成用の詳細プロンプト
   - **動画ファイル**: メディアライブラリから動画を選択

## 高度な機能

### シーンの並び替え

- シーン一覧で左端のドラッグハンドル（≡）をドラッグして並び替え
- 順序は自動的に保存されます

### インライン編集

- シーン一覧の各フィールドをクリックすると、その場で編集可能
- フォーカスが外れると自動的に保存されます
- 保存状態は視覚的なインジケーターで確認できます

### プロジェクトの管理

- **編集**: プロジェクト名の横の編集ボタンで楽曲名・備考を変更
- **削除**: 削除ボタンで確認ダイアログ後にプロジェクトを削除
- **切り替え**: サイドメニューで別のプロジェクトに素早く切り替え

## ファイル形式とデータ構造

### サポートするファイル形式

#### シーン一括登録用ファイル

**テキストファイル (.txt)**
- 各行が1つのシーンの歌詞として登録されます
- 改行で自動的にシーンが分割されます

**CSVファイル (.csv)**
- ヘッダー行: `start_time,lyrics,description,image_prompt,video_prompt`
- 各行が1つのシーンとして登録されます
- 時間形式: `分:秒` (例: `1:30`)

#### メディアファイル

**画像ファイル**
- JPG, JPEG (.jpg, .jpeg)
- PNG (.png)
- GIF (.gif)

**動画ファイル**
- MP4 (.mp4)
- MOV (.mov)
- AVI (.avi)

### データの保存場所

アプリケーションのデータは以下の場所に保存されます：

```
music-video-creator/data/
├── projects.json              # プロジェクト一覧
└── projects/                  # プロジェクトデータ
    └── {プロジェクトID}/
        ├── config.json        # プロジェクト設定
        ├── scenes.json        # シーンデータ
        └── media/             # メディアファイル
            ├── images/        # 画像ファイル
            └── videos/        # 動画ファイル
```

## トラブルシューティング

### よくある問題と解決方法

#### 1. アプリケーションが表示されない

**症状**: ブラウザでアクセスしても画面が表示されない

**解決方法**:
- Webサーバー（Apache）が起動しているか確認
- URLが正しいか確認（`http://localhost/music-video-creator/public/`）
- PHPが有効になっているか確認

#### 2. ファイルアップロードができない

**症状**: ファイルをドロップしてもアップロードされない

**解決方法**:
- `data/projects/` ディレクトリの書き込み権限を確認
- ファイルサイズがPHPの制限を超えていないか確認
- 対応ファイル形式かどうか確認

#### 3. データが保存されない

**症状**: シーンの編集内容が保存されない

**解決方法**:
- `data/` ディレクトリの書き込み権限を確認
- ブラウザのJavaScriptが有効になっているか確認
- ブラウザの開発者ツールでエラーメッセージを確認

#### 4. 画像・動画が表示されない

**症状**: アップロードしたメディアファイルが表示されない

**解決方法**:
- ファイルが正しくアップロードされているか確認
- ブラウザのキャッシュをクリア
- ファイルパスが正しいか確認

### エラーメッセージの対処法

#### "Permission denied"
- ディレクトリの書き込み権限を確認してください
- `chmod 755 data/` コマンドで権限を設定

#### "File not found"
- ファイルパスが正しいか確認してください
- プロジェクトが正しく作成されているか確認

#### "Invalid file format"
- サポートされているファイル形式か確認してください
- ファイルが破損していないか確認

## 技術仕様

### システム構成

- **フロントエンド**: HTML5, TailwindCSS, JavaScript (ES6+)
- **バックエンド**: PHP 7.4+
- **データストレージ**: JSON ファイル
- **Webサーバー**: Apache/Nginx

### API エンドポイント

- `GET /api/projects.php` - プロジェクト一覧取得
- `POST /api/projects.php` - プロジェクト作成
- `PUT /api/projects.php?id={id}` - プロジェクト更新
- `DELETE /api/projects.php?id={id}` - プロジェクト削除
- `GET /api/scenes.php?project_id={id}` - シーン一覧取得
- `POST /api/scenes.php` - シーン作成・更新
- `POST /api/scenes.php?action=upload` - シーンファイルアップロード
- `GET /api/media.php?project_id={id}` - メディア一覧取得
- `POST /api/media.php` - メディアファイルアップロード
- `DELETE /api/media.php?file_id={id}` - メディアファイル削除

## サポート・お問い合わせ

### バックアップとデータ移行

**データのバックアップ**
- `data/` フォルダ全体をコピーしてバックアップ
- 定期的なバックアップを推奨

**データの復元**
- バックアップした `data/` フォルダを元の場所に配置
- Webサーバーを再起動

**他の環境への移行**
1. `music-video-creator/` フォルダ全体をコピー
2. 移行先でWebサーバーを設定
3. ディレクトリ権限を設定

### 開発・カスタマイズ

このアプリケーションはオープンソースとして開発されており、必要に応じてカスタマイズが可能です。

**主要ファイル**:
- `public/index.php` - メインページ
- `public/assets/js/app.js` - JavaScript機能
- `public/assets/css/style.css` - スタイルシート
- `src/` - PHPクラス
- `public/api/` - API エンドポイント

カスタマイズを行う場合は、バックアップを取ってから作業することを強く推奨します。

---

**バージョン**: 1.0.0  
**最終更新**: 2025年1月  
**対応ブラウザ**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+